{"default_url":null,"content":{"state":0,"taskInstructions":"If you identify a Blob storage SAS token URL (see below) in the application, check the &quot;sp&quot; parameter for the permissions on the SAS token.\n\nIn the example below, we can see that the token allows everything (rwdlacupitfx). Most importantly, look for read/write/list permissions, and where they're scoped (SS parameter). Use the attached finding to call out the issue. \n\n<ncode>https://netspiexample.blob.core.windows.net/folder/file.txt?sv=2020-08-04&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupitfx&amp;se=2020-11-03T04:40:45Z&amp;st=2020-11-02T20:40:45Z&amp;spr=https,http&amp;sig=tfTo6fdiC2e79wqf54XOAY06Vd%2BAQXy2nBukQRH48kQ%3D\n</ncode>\nIn this case, you could modify the link for file.txt to the following link to list out the files in the &quot;folder&quot; directory:\n<ncode>https://netspiexample.blob.core.windows.net<b><red>/folder/?restype=container&amp;comp=list</red></b>&amp;sv=2020-08-04&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupitfx&amp;se=2020-11-03T04:40:45Z&amp;st=2020-11-02T20:40:45Z&amp;spr=https,http&amp;sig=tfTo6fdiC2e79wqf54XOAY06Vd%2BAQXy2nBukQRH48kQ%3D\n</ncode>\n\nFor additional information on the SAS token parameters:\n<ncode>sv=2020-08-04 - Sig Version\nss=bfqt - Services Allowed\n\t(B)lob\n\t(F)ile\n\t(Q)ueue\n\t(T)able\nsrt=c - Allowed resource types\n\t(s)ervice\n\t(c)ontainer\n\t(o)bject\nsp=rwdlacupitfx - Allowed permissions\n\t(R)ead\n\t(W)rite\n\t(D)elete\n\t(L)ist\n\t(A)dd\n\t(C)reate\n\t(U)pdate\n\t(P)rocess\n\t(I)mmutable storage\n\tx - Enables deletion of versions\n\tt - Allowed blob index permissions (R/W)\n\tf - Allowed blob index permissions (Filter)\nse=2021-11-03T03:38:51Z - End of Use\nst=2021-11-02T19:38:51Z - Start of Use\nspr=https - Allowed Protocol(s)\nsig=8%2BpGGfE4ymEtDH8NfvXtlVp1gr3zLKwDcu8Ll%2FnkcRA%3D - Signature\n</ncode>\n","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17088270,"exploitInstructions":null,"verificationInstructions":null,"remediationInstructions":"Modify the existing process for creating SAS tokens with the application. Restrict the access for token to prevent the exposure of files to unintended users.\n","name":"Excessive Permissions - Storage Account SAS Token - Azure","sourceId":"M:7211f265-78ee-4a6f-8740-bb00b292e567","severity":"High","businessImpact":"Depending on the permissions granted, the excessive permissions could allow a user to complete any of the following actions:\n<ul><li>List additional files in the account</li>\n<li>Read and/or write existing files and folders belonging to other users</li>\n<li>Access additional file services (Blob, File, Table, Queue) within the Storage Account</li>\n</ul>\n","description":"The affected Azure Storage Account utilizes excessive permissions when creating Shared Access Signatures (SAS) for accessing files.\n"}}}