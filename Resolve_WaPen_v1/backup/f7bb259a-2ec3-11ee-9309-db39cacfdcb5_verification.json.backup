{"default_url":null,"content":{"state":0,"taskInstructions":"<h3>Burp Suite Setup Instructions:</h3>\n<ol><li>Ensure Burp is at the latest version. Click Help -&gt; Check for updates</li>\n<li>Load the <a href='https://outline.netspi.com/doc/burp-suite-pro-N9NzFlicQU'>NetSPI Standard Burp Project Configurations file</a>:</li>\n<li class='depth1'>Setting &gt; Manage Global Settings &gt; Project Settings &gt; Load Project Settings</li>\n<li>Install Burp Extensions from the <a href='https://outline.netspi.com/doc/burp-suite-pro-N9NzFlicQU'>up-to-date list maintained in Outline</a></li>\n<li>Confirm Burp Collaborator is reachable by running a health check.</li>\n</ol>\n\n<h3>Burp Suite Active Scanning Setup:</h3>\n<ol><li>Set the Scope:</li>\n<li class='depth1'>Target &gt; Site Map &gt; Right-click the item and select &quot;Add to Scope&quot; for each location that is considered in scope.</li>\n<li class='depth1'>Target &gt; Scope settings &gt; Check Advanced Scope Control &gt; Click Add and manually enter all the details that matches the scope of the project.</li>\n<li>Create new Audit Configurations:</li>\n<li class='depth1'>Dashboard &gt; Click the &quot;Gear&quot; under Live audit from Proxy &gt; Scan configuration &gt; New &gt; <b><red>Cookies_Headers</red></b></li>\n<li class='depth2'>Under Insertion Point Types &gt; Uncheck everything except <b>Cookie parameter values</b> and <b>HTTP Headers</b></li>\n<li class='depth2'>Under Misc Insertion Point Options &gt; Change the maximum to 1000</li>\n<li class='depth1'>Dashboard &gt; Click the &quot;Gear&quot; under Live audit from Proxy &gt; Scan configuration &gt; New &gt; <b><red>NO_Cookies_Headers</red></b></li>\n<li class='depth2'>Under Insertion Point Types &gt; Uncheck <b>Cookie parameter values</b> and <b>HTTP Headers</b></li>\n<li class='depth2'>Under Misc Insertion Point Options &gt; Change the maximum to 1000</li>\n</ol>\n<h3>Instructions:</h3>\n<ol><li>Scan a request that includes all cookies and headers used by the application using the new Cookies_Headers Audit Configuration.</li>\n<li>Scan all application pages that accept parameters with the NO_Cookies_Headers Audit Configuration.</li>\n<li>To scan a single request, right-click on a request in the Proxy tab/Repeater tab &gt; Do active scan.</li>\n<li>You can scan multiple requests at the same time by holding Control while selecting the requests, then right-clicking, and selecting Do an active scan.</li>\n<li>Monitor automated scans in Logger to ensure that the session stays active. Especially when many scans are queued or they just go slowly.</li>\n</ol>\n<h3>Session Refreshing (as needed):</h3>\nCreate a Login macro following these instructions:\n<ol><li>Settings &gt; Sessions &gt; Macros</li>\n<li>Click Add and name the new macro &quot;Login refresh&quot; or similar</li>\n<li>In the Macro Recorder window that appears (if it doesn't, click the Record Macro button), select the request(s) necessary to successfully authenticate; if there are redirects as part of the natural flow only the original request that submits the username and password is necessary.</li>\n<li>Click OK with the appropriate requests selected and Click OK after giving the Macro a name.</li>\n</ol>\nConfigure a Session Handler to use the macro from above to automatically submit the login macro when the session has expired:\n<ol><li>Settings &gt; Sessions &gt; Session Handling Rules</li>\n<li>Click Add and give the rule a description or name such as &quot;Refresh session.&quot;</li>\n<li>Under Rule Actions &gt; Add &gt; Select &quot;Check Session is Valid&quot; from the drop down</li>\n<li>In the pop up window, leave &quot;Issue current request&quot; selected</li>\n<li>Check &quot;Validate Session every X requests&quot;</li>\n<li class='depth1'>This can be altered later if the session isn't being refreshed often enough</li>\n</ol>\nNext, select the appropriate location in the request for Burp to search for clues whether the session is valid or not. This requires knowing how the application responds to an expired session. You can figure this out either by making an authenticated request without cookies/auth headers, letting the session expire and submitting an old request, or logging out and submitting an old request. Configure the expression to match as uniquely as possible with the response without being too large. Use a simple string match and case sensitive match if possible to reduce the processing time.\n\nConfigure behavior dependent session validity section:\n<ol><li>The &quot;If session is valid...&quot; box will be automatically checked and greyed out</li>\n<li>Check the &quot;If session is invalid...&quot; box and leave Run a macro in the drop down</li>\n<li>Select the macro from earlier steps</li>\n<li>Configure the options for updating based on the response. Typically this only involves unchecking the &quot;Update current request parameters...&quot; and finish by clicking OK</li>\n<li>Click the Scope tab &gt; select all tools you'd like to have a sessions refreshed automatically (typically everything except Proxy).</li>\n<li>Under the URL Scope section, select Use Suite Scope and click OK.</li>\n</ol>\n\n","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":null}}