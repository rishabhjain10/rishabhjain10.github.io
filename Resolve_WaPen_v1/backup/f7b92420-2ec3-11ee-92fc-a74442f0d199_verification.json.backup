{"default_url":null,"content":{"state":0,"taskInstructions":null,"references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17054637,"exploitInstructions":"","verificationInstructions":"<b>Verification Instructions</b>\n\nAttempt to upload arbitrary files, such as ipconfig.exe, to the server. Attempt to bypass any client-side or server-side controls that are used to restrict upload capabilities:\n<ul><li>modify file extension in Burp</li>\n<li>modify file content-type in Burp</li>\n</ul>\n<b>Reporting Requirements</b>\n<ol><li>Add description to detail what kind of files are allowed to be uploaded</li>\n<li>Show file upload functionality</li>\n<li>Show upload of an arbitrary file</li>\n<li>If necessary, show request content modification in Burp</li>\n<li>Show that the uploaded file is accessible on the server</li>\n</ol>\n","remediationInstructions":"Ensure that server-side controls are put into place that validate and restrict uploaded file extensions, locations, and content to only that which is required for a defined business purpose.\nFollow these recommendations to secure file upload functionality:\n<ul><li>Check file extension</li>\n<li>Reject special characters in file names such as \"/\" and \";\"</li>\n<li>Rename user uploaded content, and add the expected file extension</li>\n<li>When possible, check file signatures for binary files (such as image or PDF files)</li>\n<li>When expected file upload is an image, render the content when accessed, for example by using &lt;img&gt; tags</li>\n<li>For arbitrary files (such as executables) that can be uploaded and accessed, serve the files with \"Content-Disposition: attachment\" header instead of rendering the file</li>\n<li>If uploaded content saved as files instead of saving into a database, save uploaded content outside of webroot; do not allow direct access to uploaded files via the application</li>\n<li>Do not allow execution from upload folder</li>\n<li>Limit file sizes</li>\n<li>Use anti-virus when possible to scan uploaded content</li>\n<li>If compressed file uploads are extracted on the server, apply these directions to each file one by one</li>\n</ul>\n","name":"File Upload - Unvalidated File Allowed","sourceId":"M:e5eec5b9-3485-e411-9c10-001e4f12001c","severity":"Medium","businessImpact":"Permitting users to upload files can allow attackers to inject dangerous content or malicious code to run on the server. Depending on whether file path, file extension and file content are controllable or not, attackers may be able to:\n<ul><li>Upload web forms to the web directories to gain remote code execution.</li>\n<li>Upload malware/virus to web directories to attack other users.</li>\n<li>Upload large file to cause Denial-of-Service condition.</li>\n<li>Overwrite critical system files, cause Denial-of-Service, backdoor system, or gain remote access through other means.</li>\n</ul>\n","description":"The application allows users to upload arbitrary files.\n"}}}