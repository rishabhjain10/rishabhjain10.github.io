{"default_url":null,"content":{"state":0,"taskInstructions":null,"references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":837,"exploitInstructions":"","verificationInstructions":"<b>Verification Instructions</b>\n\nDetermine what the session cookies are for the application. Authenticate to the application and check for \"Set-Cookie:\" in the HTTP response. If the cookie does not contain the text \"HTTPOnly\", then this finding is verified. \n\nNote: This is only necessary for session cookies or cookies that appear to contain some sensitive information.\n\n<b>Reporting Requirements</b>\n\n<ol><li>Show login request and response - highlight the Set-Cookie header that does not set HTTPOnly for the session cookie</li>\n</ol>\n","remediationInstructions":"Ensure that the HTTPOnly flag is set for all cookies that contain sensitive information. The HTTPOnly flag can be set either in application code or in the web server configurations.\n\nThe following examples illustrate how to set the HTTPOnly flag in some widely used web application configurations. For specific instructions, please refer to the server or programming language manual.\n\nTo set the HTTPOnly flag for all cookies in IIS, insert the following code to the web.config inside the system.web tag:\n<ncode>&lt;httpCookies httpOnlyCookies=\"true\" requireSSL=\"true\"/&gt;\n</ncode>\nNote that the code above also sets the secure flag for all cookies.\n\nTo set the HTTPOnly flag for all cookies in Tomcat 6.0 and newer, insert the following code to the context.xml file:\n<ncode>&lt;Context useHttpOnly=\"true\"&gt;...&lt;/Context&gt;\n</ncode>\n\nTo set the HTTPOnly flag for all cookies in Servlet 3.0, insert the following code to the web.xml file:\n<ncode>&lt;session-config&gt;\n &lt;cookie-config&gt;\n  &lt;http-only&gt;true&lt;/http-only&gt;\n &lt;/cookie-config&gt;\n&lt;/session-config&gt;\n</ncode>\n\nTo set the secure flag for a specific cookie within the application code:\n<ul><li>ASP.NET:</li>\n</ul>\n<ncode>HttpCookie cookie = new HttpCookie('cookiename');\ncookie.HttpOnly = True; \n</ncode>\n<ul><li>Java:</li>\n</ul>\n<ncode>String sessionid = request.getSession().getId();\nresponse.setHeader(\"SET-COOKIE\", \"JSESSIONID=\" + sessionid + \"; HttpOnly\");\n</ncode>\n\nFor SiteMinder make the Web Agent set the HTTP-Only attribute for any cookies it creates using the following parameter:\n<ncode>UseHTTPOnlyCookies\n</ncode>\nThis parameter instructs the Web Agent to set the HTTP-only attribute on the cookies it creates. The default setting for this parameter is NO. To safeguard the information in cookies, set the value of the UseHTTPOnlyCookies parameter to yes.\n","name":"Missing Cookie Flag - HTTPOnly","sourceId":"GID:3237","severity":"Low","businessImpact":"The lack of HTTPOnly cookies increases the risk of exposure or manipulation of sensitive cookie data through cross-site scripting attacks.  Cookie manipulation or exposure can allow an attacker to steal a user's session and gain access to their account.\n","description":"One or more cookies were discovered that did not have the HTTPOnly flag set. This security feature helps mitigate the possibility of a successful cross-site scripting attack by not allowing cookies with the HTTPOnly attribute to be accessed through client-side scripts.\n"}}}