{"default_url":null,"content":{"state":0,"taskInstructions":"If you identify a Blob storage SAS token URL (see below) in the application, check the &quot;sp&quot; parameter for the permissions on the SAS token.<br><br>In the example below, we can see that the token allows everything (rwdlacupitfx). Most importantly, look for read/write/list permissions, and where they're scoped (SS parameter). Use the attached finding to call out the issue. <br><br><code>https://netspiexample.blob.core.windows.net/folder/file.txt?sv=2020-08-04&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupitfx&amp;se=2020-11-03T04:40:45Z&amp;st=2020-11-02T20:40:45Z&amp;spr=https,http&amp;sig=tfTo6fdiC2e79wqf54XOAY06Vd%2BAQXy2nBukQRH48kQ%3D<br></code><br>In this case, you could modify the link for file.txt to the following link to list out the files in the &quot;folder&quot; directory:<br><code>https://netspiexample.blob.core.windows.net<b><red>/folder/?restype=container&amp;comp=list</red></b>&amp;sv=2020-08-04&amp;ss=bfqt&amp;srt=sco&amp;sp=rwdlacupitfx&amp;se=2020-11-03T04:40:45Z&amp;st=2020-11-02T20:40:45Z&amp;spr=https,http&amp;sig=tfTo6fdiC2e79wqf54XOAY06Vd%2BAQXy2nBukQRH48kQ%3D<br></code><br><br>For additional information on the SAS token parameters:<br><code>sv=2020-08-04 - Sig Version<br>ss=bfqt - Services Allowed<br>\t(B)lob<br>\t(F)ile<br>\t(Q)ueue<br>\t(T)able<br>srt=c - Allowed resource types<br>\t(s)ervice<br>\t(c)ontainer<br>\t(o)bject<br>sp=rwdlacupitfx - Allowed permissions<br>\t(R)ead<br>\t(W)rite<br>\t(D)elete<br>\t(L)ist<br>\t(A)dd<br>\t(C)reate<br>\t(U)pdate<br>\t(P)rocess<br>\t(I)mmutable storage<br>\tx - Enables deletion of versions<br>\tt - Allowed blob index permissions (R/W)<br>\tf - Allowed blob index permissions (Filter)<br>se=2021-11-03T03:38:51Z - End of Use<br>st=2021-11-02T19:38:51Z - Start of Use<br>spr=https - Allowed Protocol(s)<br>sig=8%2BpGGfE4ymEtDH8NfvXtlVp1gr3zLKwDcu8Ll%2FnkcRA%3D - Signature<br></code><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17088270,"exploitInstructions":null,"verificationInstructions":null,"remediationInstructions":"Modify the existing process for creating SAS tokens with the application. Restrict the access for token to prevent the exposure of files to unintended users.<br>","name":"Excessive Permissions - Storage Account SAS Token - Azure","sourceId":"M:7211f265-78ee-4a6f-8740-bb00b292e567","severity":"High","businessImpact":"Depending on the permissions granted, the excessive permissions could allow a user to complete any of the following actions:<br><ul><li>List additional files in the account</li><br><li>Read and/or write existing files and folders belonging to other users</li><br><li>Access additional file services (Blob, File, Table, Queue) within the Storage Account</li><br></ul><br>","description":"The affected Azure Storage Account utilizes excessive permissions when creating Shared Access Signatures (SAS) for accessing files.<br>"}}}