{"default_url":null,"content":{"state":2,"taskInstructions":"<h2>Instructions</h2><br>Determine if the SMTP domains lack DKIM records. <br><br><h3><b>Guidelines</b></h3><br><ul><li>Managed and Federated domains that appear to be email domains, have SPF and MX records.</li><br><li>Generally don't report on domains that don't have SPF and MX records unless you can verify its used for email.</li><br><li>If its a default mx records like &quot;mail.domain.com&quot;, do some additional verification.</li><br></ul><br>Typically a DKIM signature will need to be retrieved from the email headers from an email obtained during communication with the client. Check the email properties in Outlook for the email header info and look for a DKIM signature such as the one below:<br><code>DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;<br>  <b><red>d=verisign.com</red></b>; l=32873; q=dns/txt; <b><red>s=VRSN</red></b>;<br>  t=1601401722;<br>  h=from:to:cc:date:message-id:mime-version:subject;<br>  bh=DTKO5HVYiY/N1KPkn9sUNYVyX+W6YZtDm7HgsUwH0sQ=;<br>  b=e62LEvcMxOzHAcOd7fMJ0MjZqxFLbtQIpmQV/NL4jIjTbkiXMZpPzkOL<br>   gblFKfxLqsu3jRe7VrNWbFYwAA2GjGE9tdIiLfmkgXcgoeJpXHdBoQxbs<br>   yphas/FcSCJksz7elGhJ1TMK9CBz+xYdmErC47g+t7X+SU1qtH1p+dxzx<br>   O7kfrJmn3JHp+TWDxNln7zZ8ZXz91HcT90gj44TQOaw3govRV3kCCg33A<br>   HevXc3gcycWRpsW2bjrTxeiTKSGaYcJmTivWXDdv1qETYrn/cTiLzwxpF<br>   bWiURKYaXz7wLE1ZdQig63yurg8ZLU+4O6Sk9nZhv1qt44h03TYrdSuIi<br>   g==;<br></code><br>The values in the &quot;d&quot; (domain) and &quot;s&quot; (selector) fields of the signature can be used to perform a DNS lookup as shown below. The format for the DKIM record query is <code>&lt;selector&gt;._domainkey.&lt;domain&gt;</code>:<br><code><b>&#35; dig @1.1.1.1 txt </b><b><red>VRSN</red></b><b>._domainkey.</b><b><red>verisign.com</red></b><br><br>; &lt;&lt;&gt;&gt; DiG 9.16.6-Debian &lt;&lt;&gt;&gt; @1.1.1.1 txt VRSN._domainkey.verisign.com<br>; (1 server found)<br>;; global options: +cmd<br>;; Got answer:<br>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 52638<br>;; flags: qr rd ra ad; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1<br><br>;; OPT PSEUDOSECTION:<br>; EDNS: version: 0, flags:; udp: 1232<br>;; QUESTION SECTION:<br>;VRSN._domainkey.verisign.com.  IN      TXT<br><br><b>;; ANSWER SECTION:</b><br><b><red>VRSN._domainkey.verisign.com. 900 IN    TXT     &quot;v=DKIM1; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArGA05xRUv76X9YLzkPzPeilbCvyF/RctsgvpHYoJAMX94gWuJ+UE3rGLmIkrRAayZrDNUqEf3wBsTrilDEoJa2YZz1DbNUe5j657cpjf+rGGaMbs40BqEbnWq1eKOgXT1VcxnwS1UWO+EUV3S/s/+WVYz9TR+Jkjkc9gtLgKm4btf1O3hzeyZkw2iqWyytYvR3bWF699&quot; &quot;KMGbCxsrMgNDZ9U/7ddnY5Z8WD6TplDs9UM/oduzEG+JAH8jUEJqI4YRIHPN+iQGRQnVhAMRD7wJBkeZZUTWwvLTU08oWCXHRAiRw9Xlsfg0xVFBjwnAx8KtQcyMzZEwVCuq/POBp5I6MQIDAQAB;&quot;</red></b><br><br>;; Query time: 88 msec<br>;; SERVER: 1.1.1.1&#35;53(1.1.1.1)<br>;; WHEN: Mon Oct 05 16:20:18 CDT 2020<br>;; MSG SIZE  rcvd: 475<br></code><br>Look for the DKIM TXT record to come back in the DNS response. If the client doesn't use DKIM, create a finding for it.<br><br>If you do not have emails from the client to inspect headers from, try to determine the mail provider through MX records and use a common selector for the provider. Below are some common selectors for a few email providers:<br><br><b>Google</b><br>    google<br><b>Microsoft</b><br>    selector1<br>    selector2<br><b>Everlytic</b><br>    everlytickey1<br>    everlytickey2<br>    eversrv (OLD selector)<br><b>MailChimp / Mandrill</b><br>    k1<br><b>Global Micro </b><br>    mxvault<br><b>Hetzner</b><br>    dkim<br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":null}}