{"default_url":null,"content":{"state":3,"taskInstructions":"<h2>Instructions</h2><br>If a mail server is in scope the VRY command (among others) can be used to validate the email addresses discovered via public resources. Additionally, some web applications that support integrated authentication will respond with differently if a validate domain user is provided.<br><ul><li>Once the accounts and emails are verified they can be used in dictionary and phishing attacks.</li><br><li>Verify potential email addresses.</li><br><li>Verify potential domain account when possible.</li><br></ul><br><h2><b>Variation: Metasploit</b></h2><br>1. Launch Metasploit.<br><code>msfconsole<br></code><br>2. Use the smtp_enum module.<br><code>use auxiliary/scanner/smtp/smtp_enum<br></code><br>3. Set the list of email address enumerated through parsing social media. <br><code>set user_file /tmp/emails_list.txt<br></code><br>4. Set the remote IP.<br><code>set rhosts IP<br></code><br>5. Exploit.<br><code>exploit<br></code><br>Alternatively, use the script from pentest monkey.<br><code>http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum<br></code><br><h2><b>Variation: Manual</b></h2><br>1. Use telnet to connect to the SMTP port.<br><code>$ telnet x.x.x.x 25<br>Trying x.x.x.x...<br>Connected to mail.test.com (x.x.x.x).<br>Escape character is '^]'.<br>220 mail.test.com ESMTP<br>ehlo localhost<br>250-mail.test.com<br>250-8BITMIME<br>250 SIZE 10485760<br>vrfy root<br>252 ok<br></code><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":122366,"exploitInstructions":"If a mail server is in scope the VRY command (among others) can be used to validate the email addresses discovered via public resources.  Addtionally, some web applications that support integrated authentication will repsond with differantly if a validate domain user is provided.<br><br>Once the accounts and emails are verified they can be used in dictionary and phishing attacks.<br><br>Verify potential email addresses.<br>Verify potential domain account when possible.<br><br><b>Metasploit instructions</b><br><br>use auxiliary/scanner/smtp/smtp_enum<br>user_file /tmp/emails_list.txt   (list of email address enumerated through parsing social media)<br>set rhosts IP<br>exploit<br><br>Alternatively, use the script from pentest monkey.<br><br>http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum<br><br><b>Manual Test</b><br><br>$ telnet x.x.x.x 25<br>Trying x.x.x.x...<br>Connected to mail.test.com (x.x.x.x).<br>Escape character is '^]'.<br>220 mail.test.com ESMTP<br>ehlo localhost<br>250-mail.test.com<br>250-8BITMIME<br>250 SIZE 10485760<br>vrfy root<br>252 ok","verificationInstructions":"If a mail server is in scope the VRY command (among others) can be used to validate the email addresses discovered via public resources.  Addtionally, some web applications that support integrated authentication will repsond with differantly if a validate domain user is provided.<br><br>Once the accounts and emails are verified they can be used in dictionary and phishing attacks.<br><br>Verify potential email addresses.<br>Verify potential domain account when possible.<br><br><b>Metasploit instructions</b><br><br>use auxiliary/scanner/smtp/smtp_enum<br>user_file /tmp/emails_list.txt   (list of email address enumerated through parsing social media)<br>set rhosts IP<br>exploit<br><br>Alternatively, use the script from pentest monkey.<br><br>http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum<br><br><b>Manual Test</b><br><br>$ telnet x.x.x.x 25<br>Trying x.x.x.x...<br>Connected to mail.test.com (x.x.x.x).<br>Escape character is '^]'.<br>220 mail.test.com ESMTP<br>ehlo localhost<br>250-mail.test.com<br>250-8BITMIME<br>250 SIZE 10485760<br>vrfy root<br>252 ok<br>","remediationInstructions":"Disable the VRFY command.<br>","name":"Weak Configuration - SMTP - VRFY Available","sourceId":"GID:4428","severity":"Low","businessImpact":"Being able to verify particular user names is very useful to attackers. Some user names are the same as system names, and some accounts have identical user names and passwords. Having valid usernames allows an attacker to focus additional attacks on the network, potentially making them more successful.","description":"The SMTP server running on this host allows the VRFY command. The VRFY command allows an anonymous user to confirm that an argument properly identifies a user. If the argument is a valid user's name, Sendmail will reply with the user's full name and mailbox. This information is useful to remote intruders both for purposes of social engineering and guessing account passwords.<br>"}}}