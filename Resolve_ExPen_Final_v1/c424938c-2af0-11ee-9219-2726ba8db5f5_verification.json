{"default_url":null,"content":{"state":2,"taskInstructions":"<h2>Instructions</h2><br>Determine if the SMTP domains lack DMAC records.  Refer to the linked finding instructions and add results to the verification.  <br><br><h3><b>Guidelines</b></h3><br><ul><li>Managed and Federated domains that appear to be email domains, have SPF and MX records.</li><br><li>Generally don't report on domains that don't have SPF and MX records unless you can verify its used for email.</li><br><li>If its a default mx records like &quot;mail.domain.com&quot;, do some additional verification.</li><br></ul><br><h2>Variation: dig</h2><br>1. Use dig to identify DMARC records.<br><code><b>dig txt _dmarc.google.com +short</b><br><br>&quot;v=DMARC1; p=reject; rua=mailto:mailauth-reports@google.com&quot;<br></code><br><h2>Variation: checkdmarc</h2><br>1. Install checkdmarc.<br><code>pip install checkdmarc<br></code><br>2. Run checkdmarc against the target domain and use jq to filter for the DMARC record.<br><code><b>checkdmarc google.com | jq '.dmarc.record'</b><br><br>&quot;v=DMARC1; p=reject; rua=mailto:mailauth-reports@google.com&quot;<br></code><br><h2>Variation: dnsrecon</h2><br>1. Run dnsrecon and review the returned records.<br><code><b>dnsrecon -d google.com<br><br></b>[&#42;] std: Performing General Enumeration against: google.com...<br>[-] DNSSEC is not configured for google.com<br>[&#42;]      SOA ns1.google.com 216.239.32.10<br>[&#42;]      SOA ns1.google.com 2001:4860:4802:32::a<br>[&#42;]      NS ns4.google.com 216.239.38.10<br>[&#42;]      NS ns4.google.com 2001:4860:4802:38::a<br>[&#42;]      NS ns3.google.com 216.239.36.10<br>[&#42;]      NS ns3.google.com 2001:4860:4802:36::a<br>[&#42;]      NS ns1.google.com 216.239.32.10<br>[&#42;]      NS ns1.google.com 2001:4860:4802:32::a<br>[&#42;]      NS ns2.google.com 216.239.34.10<br>[&#42;]      NS ns2.google.com 2001:4860:4802:34::a<br>[&#42;]      MX smtp.google.com 172.217.212.27<br>[&#42;]      MX smtp.google.com 172.253.114.27<br>[&#42;]      MX smtp.google.com 172.253.119.27<br>[&#42;]      MX smtp.google.com 108.177.111.27<br>[&#42;]      MX smtp.google.com 74.125.124.27<br>[&#42;]      MX smtp.google.com 2607:f8b0:4001:c03::1a<br>[&#42;]      MX smtp.google.com 2607:f8b0:4001:c22::1b<br>[&#42;]      MX smtp.google.com 2607:f8b0:4001:c23::1a<br>[&#42;]      MX smtp.google.com 2607:f8b0:4001:c14::1b<br>[&#42;]      A google.com 142.250.191.174<br>[&#42;]      AAAA google.com 2607:f8b0:4009:819::200e<br>[&#42;]      TXT google.com v=spf1 include:_spf.google.com ~all<b><br></b>[&#42;]      TXT google.com facebook-domain-verification=22rm551cu4k0ab0bxsw536tlds4h95<br>[&#42;]      TXT google.com apple-domain-verification=30afIBcvSuDV2PLX<br>[&#42;]      TXT google.com globalsign-smime-dv=CDYX+XFHUw2wml6/Gb8+59BsH31KzUr6c1l2BPvqKX8=<br>[&#42;]      TXT google.com docusign=05958488-4752-4ef2-95eb-aa7ba8a3bd0e<br>[&#42;]      TXT google.com google-site-verification=TV9-DBe4R80X4v0M4U_bd_J9cpOJM0nikft0jAgjmsQ<br>[&#42;]      TXT google.com MS=E4A68B9AB2BB9670BCE15412F62916164C0B20BB<br>[&#42;]      TXT google.com docusign=1b0a6754-49b1-4db5-8540-d2c12664b289<br>[&#42;]      TXT google.com google-site-verification=wD8N7i1JTNTkezJ49swvWW48f8_9xveREV4oB-0Hf5o<br>[&#42;]      <b><red>TXT _dmarc.google.com v=DMARC1; p=reject; rua=mailto:mailauth-reports@google.com</red></b><br><b>[TRUNCATED]</b><br></code><br><h2><b>Variation: nslookup</b></h2><br>1. Use nslookup and review the returned records.<br><code><b>nslookup -type=txt _dmarc.google.com</b><br><br>Server:         172.24.0.1<br>Address:        172.24.0.1&#35;53<br><br>Non-authoritative answer:<br>_dmarc.google.com       text = &quot;v=DMARC1; p=reject; rua=mailto:mailauth-reports@google.com&quot;<br><br>Authoritative answers can be found from:<br></code><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17065129,"exploitInstructions":"","verificationInstructions":"nslookup -q=TXT SMTPdomain.com<br><br>nslookup -type=txt _dmarc.netspi.com 8.8.8.8<br>nslookup -q=txt _dmarc.SMTPdomain.com<br><br>One of the TXT records should appear as the following (The v and p flags are required, others optional, although they will not recieve feedback without an rua or ruf flag)<br><br>v=DMARC1;p=reject;sp=reject;pct=100;adkim=r;aspf=r;fo=1;ri=86400;rua=mailto:dmarc-admin@SMTPdomain.com<br><br><br>or for JSON output of DMARC records:<br><br>checkdmarc domain.com<br><br>If this record is not present the domain is not using DMARC.<br>","remediationInstructions":"Publish a DMARC TXT DNS record for the affected domain with either the <code>p=reject</code> or <code>p=quarantine</code> policy value specified. Publishing a DMARC TXT DNS record for a domain using the <code>p=none</code> policy value, while potentially useful for initial deployment planning, does not protect the organization and should only be used as a temporary step towards implementation of one of the other policy values.<br>","name":"Weak Configuration - SMTP - DMARC Record Not Set","sourceId":"M:3eb54af0-0472-4bf6-a9b9-3271865be9b6","severity":"Low","businessImpact":"Domains which do not supply DMARC information may be more prone to email spoofing attacks, or not receive information that such an attack has occurred.<br>","description":"Domain-based Message Authentication, Reporting &amp; Conformance (DMARC) is a policy that allows participating domains to signal the use of email identity authentication, and provide automated feedback between participating organizations. Should a malicious actor attempt to spoof emails from the domain, the spoofed emails will fail authentication, and it is possible for the recipient to alert the true owner of the domain to the spoof attempt. Although the lack of a DMARC policy is not a vulnerability in itself, it can make verifying the authenticity of emails from the domain more difficult.<br>"}}}