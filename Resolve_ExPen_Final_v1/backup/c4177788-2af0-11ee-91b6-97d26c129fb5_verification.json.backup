{"default_url":null,"content":{"state":2,"taskInstructions":"<h2>Instructions</h2><br>Determine if DNSSEC is configured for domains. If so, DNS enumeration might be possible if NSEC records are used. If NSEC3 records are used, enumeration is not possible.<br><br><h2>Variation: delv</h2><br>1. Use the linux tool delv to determine if DNSSEC is configured.<br><code>delv @1.1.1.1 domain<br></code><br><h3>Example:</h3><br><code>delv @1.1.1.1 cyberciti.biz<br><br>; fully validated<br>cyberciti.biz.          300     IN      A       172.66.40.203<br>cyberciti.biz.          300     IN      A       172.66.43.53<br>cyberciti.biz.          300     IN      RRSIG   A 13 2 300 20220511212602 20220509192602 34505 cyberciti.biz. 0+LplFzevJJgd03MwlUQZ/UJ3yhfF8QMwf76vKTorglUqoV8BiFV9WdE BXpKN4E067iVA15m7usBkVLDFJsuaA==<br></code><br><h2>Variation: dnsrecon</h2><br>1. Install dnsrecon.<br><code>sudo apt install dnsrecon<br></code><br>2. Run the following command to determine if DNSSEC is configured.<br><code>dnsrecon -z -d domain<br></code><br><h3>Example:</h3><br><code>dnsrecon -z -d cyberciti.biz<br><br>[&#42;] std: Performing General Enumeration against: cyberciti.biz...<br>[&#42;] DNSSEC is configured for cyberciti.biz<br>[&#42;] DNSKEYs:<br>[&#42;]     <b><red>NSEC</red></b> KSk ECDSAP256SHA256 99db2cc14cabdc33d6d77da63a2f15f7 1112584f234e8d1dc428e39e8a4a97e1 aa271a555dc90701e17e2a4c4b6f120b 7c32d44f4ac02bd894cf2d4be7778a19<br>[&#42;]     <b><red>NSEC</red></b> ZSK ECDSAP256SHA256 a09311112cf9138818cd2feae970ebbd 4d6a30f6088c25b325a39abbc5cd1197 aa098283e5aaf421177c2aa5d714992a 9957d1bcc18f98cd71f1f1806b65e148<br>[&#42;]      SOA dns1.cyberciti.biz 162.159.8.215<br>[&#42;]      SOA dns1.cyberciti.biz 2400:cb00:2049:1::a29f:8d7<br>[&#42;]      NS dns1.cyberciti.biz 162.159.8.215<br>[&#42;]      NS dns1.cyberciti.biz 2400:cb00:2049:1::a29f:8d7<br>[&#42;]      NS dns2.cyberciti.biz 162.159.9.173<br>[&#42;]      NS dns2.cyberciti.biz 2400:cb00:2049:1::a29f:9ad<br>[&#42;]      MX aspmx.l.google.com 172.253.115.27<br>[&#42;]      MX aspmx2.googlemail.com 209.85.202.27<br>[&#42;]      MX aspmx3.googlemail.com 64.233.184.27<br>[&#42;]      MX alt1.aspmx.l.google.com 209.85.202.26<br>[&#42;]      MX alt2.aspmx.l.google.com 64.233.184.26<br>[&#42;]      MX aspmx.l.google.com 2607:f8b0:4004:c06::1b<br>[&#42;]      MX aspmx2.googlemail.com 2a00:1450:400b:c00::1b<br>[&#42;]      MX aspmx3.googlemail.com 2a00:1450:400c:c0b::1a<br>[&#42;]      MX alt1.aspmx.l.google.com 2a00:1450:400b:c00::1b<br>[&#42;]      MX alt2.aspmx.l.google.com 2a00:1450:400c:c0b::1b<br>[&#42;]      A cyberciti.biz 172.66.43.53<br>[&#42;]      A cyberciti.biz 172.66.40.203<br>[&#42;]      AAAA cyberciti.biz 2606:4700:3108::ac42:2b35<br>[&#42;]      AAAA cyberciti.biz 2606:4700:3108::ac42:28cb<br>[&#42;]      TXT cyberciti.biz brave-ledger-verification=9b45e603f27d089b39fc038e0ce00c04056d101932a15f612ff58d011fe2f623<br>[&#42;]      TXT cyberciti.biz v=spf1 include:amazonses.com include:_spf.google.com -all<br>[&#42;]      TXT cyberciti.biz google-site-verification=oQAwJ5x8VLFhvc1DNXq_pHA0r2sF88et2Dv6hWNjzhg<br>[&#42;]      TXT _dmarc.cyberciti.biz v=DMARC1; p=reject; pct=100; rua=mailto:webmaster@nixcraft.com; ruf=mailto:webmaster@nixcraft.com; fo=1; ri=2419200;<br>[&#42;] Enumerating SRV Records<br>[+] 0 Records Found<br>[&#42;] <b><red>Performing NSEC Zone Walk for cyberciti.biz</red></b><br>[&#42;] Getting SOA record for cyberciti.biz<br>[&#42;] Name Server 162.159.8.215 will be used<br>[&#42;]      A cyberciti.biz 172.66.40.203<br>[&#42;]      A cyberciti.biz 172.66.43.53<br>[&#42;]      AAAA cyberciti.biz 2606:4700:3108::ac42:2b35<br>[&#42;]      AAAA cyberciti.biz 2606:4700:3108::ac42:28cb<br>[+] 4 records found<br></code><br><h2>Report Requirements</h2><br><ul><li>Record internal IPs in task notes</li><br><li>Record newly discovered domains for later targeting</li><br></ul><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17063351,"exploitInstructions":"","verificationInstructions":"<br>Instructions <br><br>Perform common DNSSEC record lookups .<br><br>Perform DNSSEC Record Lookups<br><br>dnsrecon -z -d domain.com --xml /path/to/file.xml<br><br>or <br><br>dnsrecon -z -d domain.com -n [name server ip] --xml /path/to/file.xml<br><br>Report Requirements<br><br>- Record Internal IP addresses in task notes.<br>- Record newly discovered domain names for later targeting.<br>","remediationInstructions":"Disabled DNSSEC if it is note required, prevent direct access from the internet.<br>","name":"General Information - Domains - DNS SEC","sourceId":"M:8e400cad-e958-4063-9ae0-4f66ea5f1adc","severity":"Informational","businessImpact":"Information obtained could be used to target additional assets.","description":"It was possible to obtain information from common DNSSEC queries.<br>"}}}