{"default_url":null,"content":{"state":2,"taskInstructions":"<h2>Instructions</h2><br>Perform a DNS Zone Transfer and review the results.<br><br><h2>Variation: dig</h2><br>1. Use the linux tool dig to perform an axfr request.<br><code>dig axfr @target.dns.server target.domain<br></code><br><h3>Example:</h3><br><code>dig axfr @nsztm1.digi.ninja zonetransfer.me<br><br>; &lt;&lt;&gt;&gt; DiG 9.18.0-2-Debian &lt;&lt;&gt;&gt; axfr @nsztm1.digi.ninja zonetransfer.me<br>; (1 server found)<br>;; global options: +cmd<br>zonetransfer.me.        7200    IN      SOA     nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600<br>zonetransfer.me.        300     IN      HINFO   &quot;Casio fx-700G&quot; &quot;Windows XP&quot;<br>zonetransfer.me.        301     IN      TXT     &quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&quot;<br>zonetransfer.me.        7200    IN      MX      0 ASPMX.L.GOOGLE.COM.<br>zonetransfer.me.        7200    IN      MX      10 ALT1.ASPMX.L.GOOGLE.COM.<br>zonetransfer.me.        7200    IN      MX      10 ALT2.ASPMX.L.GOOGLE.COM.<br>zonetransfer.me.        7200    IN      MX      20 ASPMX2.GOOGLEMAIL.COM.<br>zonetransfer.me.        7200    IN      MX      20 ASPMX3.GOOGLEMAIL.COM.<br>zonetransfer.me.        7200    IN      MX      20 ASPMX4.GOOGLEMAIL.COM.<br>zonetransfer.me.        7200    IN      MX      20 ASPMX5.GOOGLEMAIL.COM.<br>zonetransfer.me.        7200    IN      A       5.196.105.14<br>zonetransfer.me.        7200    IN      NS      nsztm1.digi.ninja.<br>zonetransfer.me.        7200    IN      NS      nsztm2.digi.ninja.<br>_acme-challenge.zonetransfer.me. 301 IN TXT     &quot;6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI&quot;<br>_sip._tcp.zonetransfer.me. 14000 IN     SRV     0 0 5060 www.zonetransfer.me.<br>14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200 IN PTR www.zonetransfer.me.<br>asfdbauthdns.zonetransfer.me. 7900 IN   AFSDB   1 asfdbbox.zonetransfer.me.<br>asfdbbox.zonetransfer.me. 7200  IN      A       127.0.0.1<br>asfdbvolume.zonetransfer.me. 7800 IN    AFSDB   1 asfdbbox.zonetransfer.me.<br>canberra-office.zonetransfer.me. 7200 IN A      202.14.81.230<br>cmdexec.zonetransfer.me. 300    IN      TXT     &quot;; ls&quot;<br>contact.zonetransfer.me. 2592000 IN     TXT     &quot;Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes&quot;<br>dc-office.zonetransfer.me. 7200 IN      A       143.228.181.132<br>deadbeef.zonetransfer.me. 7201  IN      AAAA    dead:beaf::<br>dr.zonetransfer.me.     300     IN      LOC     53 20 56.558 N 1 38 33.526 W 0.00m 1m 10000m 10m<br>DZC.zonetransfer.me.    7200    IN      TXT     &quot;AbCdEfG&quot;<br>email.zonetransfer.me.  2222    IN      NAPTR   1 1 &quot;P&quot; &quot;E2U+email&quot; &quot;&quot; email.zonetransfer.me.zonetransfer.me.<br>email.zonetransfer.me.  7200    IN      A       74.125.206.26<br>Hello.zonetransfer.me.  7200    IN      TXT     &quot;Hi to Josh and all his class&quot;<br>home.zonetransfer.me.   7200    IN      A       127.0.0.1<br>Info.zonetransfer.me.   7200    IN      TXT     &quot;ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.&quot;<br>internal.zonetransfer.me. 300   IN      NS      intns1.zonetransfer.me.<br>internal.zonetransfer.me. 300   IN      NS      intns2.zonetransfer.me.<br>intns1.zonetransfer.me. 300     IN      A       81.4.108.41<br>intns2.zonetransfer.me. 300     IN      A       167.88.42.94<br>office.zonetransfer.me. 7200    IN      A       4.23.39.254<br>ipv6actnow.org.zonetransfer.me. 7200 IN AAAA    2001:67c:2e8:11::c100:1332<br>owa.zonetransfer.me.    7200    IN      A       207.46.197.32<br>robinwood.zonetransfer.me. 302  IN      TXT     &quot;Robin Wood&quot;<br>rp.zonetransfer.me.     321     IN      RP      robin.zonetransfer.me. robinwood.zonetransfer.me.<br>sip.zonetransfer.me.    3333    IN      NAPTR   2 3 &quot;P&quot; &quot;E2U+sip&quot; &quot;!^.&#42;$!sip:customer-service@zonetransfer.me!&quot; .<br>sqli.zonetransfer.me.   300     IN      TXT     &quot;' or 1=1 --&quot;<br>sshock.zonetransfer.me. 7200    IN      TXT     &quot;() { :]}; echo ShellShocked&quot;<br>staging.zonetransfer.me. 7200   IN      CNAME   www.sydneyoperahouse.com.<br>alltcpportsopen.firewall.test.zonetransfer.me. 301 IN A 127.0.0.1<br>testing.zonetransfer.me. 301    IN      CNAME   www.zonetransfer.me.<br>vpn.zonetransfer.me.    4000    IN      A       174.36.59.154<br>www.zonetransfer.me.    7200    IN      A       5.196.105.14<br>xss.zonetransfer.me.    300     IN      TXT     &quot;'&gt;&lt;script&gt;alert('Boo')&lt;/script&gt;&quot;<br>zonetransfer.me.        7200    IN      SOA     nsztm1.digi.ninja. robin.digi.ninja. 2019100801 172800 900 1209600 3600<br>;; Query time: 150 msec<br>;; SERVER: 81.4.108.41&#35;53(nsztm1.digi.ninja) (TCP)<br>;; WHEN: Wed Mar 23 16:12:57 CDT 2022<br>;; XFR size: 50 records (messages 1, bytes 1994)<br></code><br><h2>Variation: dnsrecon</h2><br>1. Install dnsrecon.<br><code>sudo apt install dnsrecon<br></code><br>2.  Run the following command.<br><code>dnsrecon -d domain -a<br></code><br><h3>Example:</h3><br><code>dnsrecon -d zonetransfer.me -a<br><br>[&#42;] std: Performing General Enumeration against: zonetransfer.me...<br>[&#42;] Checking for Zone Transfer for zonetransfer.me name servers<br>[&#42;] Resolving SOA Record<br>[+]      SOA nsztm1.digi.ninja 81.4.108.41<br>[&#42;] Resolving NS Records<br>[&#42;] NS Servers found:<br>[+]      NS nsztm1.digi.ninja 81.4.108.41<br>[+]      NS nsztm2.digi.ninja 34.225.33.2<br>[&#42;] Removing any duplicate NS server IP Addresses...<br>[&#42;]<br>[&#42;] Trying NS server 34.225.33.2<br>[+] 34.225.33.2 Has port 53 TCP Open<br>[+] Zone Transfer was successful!!<br>[&#42;]      SOA nsztm1.digi.ninja 81.4.108.41<br>[&#42;]      NS nsztm1.digi.ninja 81.4.108.41<br>[&#42;]      NS nsztm2.digi.ninja 34.225.33.2<br>[&#42;]      NS intns1.zonetransfer.me 81.4.108.41<br>[&#42;]      NS intns2.zonetransfer.me 167.88.42.94<br>[&#42;]      TXT google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA<br>[&#42;]      TXT 2acOp15rSxBpyF6L7TqnAoW8aI0vqMU5kpXQW7q4egc<br>[&#42;]      TXT 6Oa05hbUJ9xSsvYy7pApQvwCUSSGgxvrbdizjePEsZI<br>[&#42;]      TXT ; ls<br>[&#42;]      TXT Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes<br>[&#42;]      TXT AbCdEfG<br>[&#42;]      TXT Hi to Josh and all his class<br>[&#42;]      TXT ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.<br>[&#42;]      TXT Robin Wood<br>[&#42;]      TXT ' or 1=1 --<br>[&#42;]      TXT () { :]}; echo ShellShocked<br>[&#42;]      TXT '&gt;&lt;script&gt;alert('Boo')&lt;/script&gt;<br>[&#42;]      PTR www.zonetransfer.me 5.196.105.14<br>[&#42;]      MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 142.251.16.27<br>[&#42;]      MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 2607:f8b0:4004:c09::1b<br>[&#42;]      MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 209.85.202.27<br>[&#42;]      MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 2a00:1450:400b:c00::1a<br>[&#42;]      MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 64.233.184.26<br>[&#42;]      MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 2a00:1450:400c:c0b::1b<br>[&#42;]      MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 209.85.202.26<br>[&#42;]      MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 2a00:1450:400b:c00::1b<br>[&#42;]      MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 64.233.184.27<br>[&#42;]      MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 2a00:1450:400c:c0b::1b<br>[&#42;]      MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 142.250.27.27<br>[&#42;]      MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 2a00:1450:4025:401::1a<br>[&#42;]      MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 142.250.153.27<br>[&#42;]      MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 2a00:1450:4013:c16::1b<br>[&#42;]      AAAA deadbeef.zonetransfer.me dead:beaf::<br>[&#42;]      AAAA ipv6actnow.org.zonetransfer.me 2001:67c:2e8:11::c100:1332<br>[&#42;]      A @.zonetransfer.me 5.196.105.14<br>[&#42;]      A asfdbbox.zonetransfer.me 127.0.0.1<br>[&#42;]      A canberra-office.zonetransfer.me 202.14.81.230<br>[&#42;]      A dc-office.zonetransfer.me 143.228.181.132<br>[&#42;]      A email.zonetransfer.me 74.125.206.26<br>[&#42;]      A home.zonetransfer.me 127.0.0.1<br>[&#42;]      A intns1.zonetransfer.me 81.4.108.41<br>[&#42;]      A intns2.zonetransfer.me 52.91.28.78<br>[&#42;]      A office.zonetransfer.me 4.23.39.254<br>[&#42;]      A owa.zonetransfer.me 207.46.197.32<br>[&#42;]      A alltcpportsopen.firewall.test.zonetransfer.me 127.0.0.1<br>[&#42;]      A vpn.zonetransfer.me 174.36.59.154<br>[&#42;]      A www.zonetransfer.me 5.196.105.14<br><b>[TRUNCATED]</b><br></code><br><h2>Report Requirements</h2><br><ul><li>Record internal IPs in task notes</li><br><li>Record newly discovered domains for later targeting</li><br><li>For the finding, also show the command and a truncated version of the output to illustrate the attack process</li><br></ul><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":16893,"exploitInstructions":"","verificationInstructions":"Instructions <br><br>Perform a DNS zone transfer.  If you don't know what domain to try, do a dig -x A.B.C.D to see the reverse dns hostname for the IP you're querying. Alternative, look at rdns for the other IP addresses associated with the project and try those. Alternatively, you can use nmap -sL or dnsrecon -r subnet.<br><br>1. Below are common commands for attempting a zone trasnfer.<br><br>dnsrecon -d domain.com -a --xml /path/to/file.xml<br><br>or <br><br>dnsrecon -d domain.com -a -n [name server ip] --xml /path/to/file.xml<br><br>or<br><br>dig axrf @192.168.1.1 domain.com<br><br><br>2.  Below are options for performing a zone transfer while targeting a specific name server.<br><br>dnsrecon -d domain.com -n [name server ip] --xml /path/to/file.xml<br><br>or<br><br>nslookup -type=srv _ldap._tcp.domain.com --xml /path/to/file.xml<br><br>$ dig axfr @dns.server domain.name<br><br><br><br><b>Report Requirements</b><br><br>- Record Internal IP addresses in task notes.<br>- Record newly discovered domain names for later targeting.<br>- For finding also show the command and a truncated version of the output to illustrate the attack process.<br>","remediationInstructions":"An access list should be used to prevent unauthorized zone transfers. For bind version 8 and 9 this can be accomplished by setting the allow-transfer option appropriately.<br>","name":"Weak Configuration - DNS - Zone Transfer","sourceId":"GID:2861","severity":"Medium","businessImpact":"By knowing the names of the various servers in your domain, an attacker may be able to launch more sophisticated attacks.","description":"The domain name server includes full zone transfer (AXFR) specification. While this mechanism is useful to replicate zone information between servers, it can also be used to gather various information for mass mailing, distributed DoS attacks, and other malicious purposes.<br>"}}}