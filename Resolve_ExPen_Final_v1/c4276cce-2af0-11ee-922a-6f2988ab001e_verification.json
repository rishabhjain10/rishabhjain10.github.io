{"default_url":null,"content":{"state":3,"taskInstructions":"<h2>Instructions</h2><br>Confirm that MFA is not required for the Azure account by using Login-AzureRmAccount to login.<br><br><h2>Variation: Manual</h2><br>1. Install the AzureRM powershell module.<br><code>install-module azurerm<br></code><br>2. Run the module.<br><code>Login-AzureRmAccount -Verbose<br>VERBOSE: Performing the operation &quot;log in&quot; on target &quot;User account in environment 'AzureCloud'&quot;.<br>Environment           : AzureCloud<br>Account               : CAG@wingsfinancial.com<br>TenantId              : 2375eba9-af99-4b2d-8eaf-7884911dde9f<br>SubscriptionId        :<br>SubscriptionName      :<br>CurrentStorageAccount :<br>PS C:\\windows\\system32&gt; get-AzureRmADUser<br>UserPrincipalName                       DisplayName             Id<br>-----------------                       -----------             --<br>1185z9@wingsfinancialcu.onmicrosoft.com Dan N. Riley            63a5d579-2789-4396-83d5-73aa2be9a8c8<br>1441@wingsfinancial.com                 Michelle Lange          fd60fdce-0181-4ef3-9b83-73e1e994fb20<br>1518@wingsfinancial.com                 Abigail Sisley          f37d4217-8239-4083-931d-c2ea1e3197c1<br>1596@wingsfinancial.com                 Karen Barrett           12cc630c-9f72-4828-82ea-4107d330f1a5<br>1598@wingsfinancial.com                 Gail Mills              48f6b83d-e0af-44ad-9bdc-db2292ab5cc6<br>1599@wingsfinancial.com                 Janet Pedersen          f2fa52c5-971e-4c88-981b-7a1c08a9b1ed<br>1600@wingsfinancial.com                 Diane Weibye-Buzzell    148936ca-47ee-49eb-b916-529d8845e05e<br>1603@wingsfinancial.com                 Phanta Liu              a05137f5-8a93-4da4-8fd8-94d62a095463<br>1608@wingsfinancial.com                 Barb Wajda              a09dbdcc-670b-4b1c-8308-ee9c8247ba90<br>get-command -module &quot;&#42;azurerm&#42;&quot;<br></code><br>3. Inspect the ADResourceProperty<br><code>PS C:\\windows\\system32&gt; Get-ADResourceProperty<br>get-azureRMAdGroup<br></code><br><h2>Variation: Azure CLI</h2><br>1. Install the needed tools.<br><code>https://docs.microsoft.com/en-us/azure/cli-install-nodejs<br>http://aka.ms/webpi-azure-cli<br>https://docs.microsoft.com/en-us/azure/xplat-cli-connect<br></code><br>2. Login to Azure<br><code>azure login -u myUserName@contoso.onmicrosoft.com<br></code><br><h2>Variation: Azure Portal</h2><br>1. Navigate to the Azure login portal.<br><code>log into https://portal.azure.com/<br></code><br><h3>Reference</h3><br><code>https://docs.microsoft.com/en-us/rest/api/<br></code><br><h2>Variation: Google Dorks</h2><br>1. In google search:<br><code>inurl:adfs/ls/IdpInitiatedSignOn.aspx site: clientdomain.com<br>inurl:/idp/startSSO.ping?PartnerSpId= site: clientdomain.com<br></code><br>If you have a page come back they typically include site where federated authentication can be used.<br><br><h3>Reference</h3><br><code>https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/introducing-azucar/<br></code><br>","references":[],"isTaskInstructionsVisible":true,"isCommentMandatory":false,"fields":[],"masterFinding":{"id":17062400,"exploitInstructions":"","verificationInstructions":"Confirm that MFA is not required for the Azure account by using Login-AzureRmAccount to login.<br><br>install-module azurerm<br><br>Login-AzureRmAccount -Verbose<br><br> VERBOSE: Performing the operation \"log in\" on target \"User account in environment 'AzureCloud'\".<br><br><br>Environment           : AzureCloud<br>Account               : CAG@wingsfinancial.com<br>TenantId              : 2375eba9-af99-4b2d-8eaf-7884911dde9f<br>SubscriptionId        : <br>SubscriptionName      : <br>CurrentStorageAccount :  <br><br>PS C:\\windows\\system32&gt; get-AzureRmADUser<br><br>UserPrincipalName                       DisplayName             Id                                  <br>-----------------                       -----------             --                                  <br>1185z9@wingsfinancialcu.onmicrosoft.com Dan N. Riley            63a5d579-2789-4396-83d5-73aa2be9a8c8<br>1441@wingsfinancial.com                 Michelle Lange          fd60fdce-0181-4ef3-9b83-73e1e994fb20<br>1518@wingsfinancial.com                 Abigail Sisley          f37d4217-8239-4083-931d-c2ea1e3197c1<br>1596@wingsfinancial.com                 Karen Barrett           12cc630c-9f72-4828-82ea-4107d330f1a5<br>1598@wingsfinancial.com                 Gail Mills              48f6b83d-e0af-44ad-9bdc-db2292ab5cc6<br>1599@wingsfinancial.com                 Janet Pedersen          f2fa52c5-971e-4c88-981b-7a1c08a9b1ed<br>1600@wingsfinancial.com                 Diane Weibye-Buzzell    148936ca-47ee-49eb-b916-529d8845e05e<br>1603@wingsfinancial.com                 Phanta Liu              a05137f5-8a93-4da4-8fd8-94d62a095463<br>1608@wingsfinancial.com                 Barb Wajda              a09dbdcc-670b-4b1c-8308-ee9c8247ba90<br><br>get-command -module \"&#42;azurerm&#42;\"<br><br> PS C:\\windows\\system32&gt; Get-ADResourceProperty <br>get-azureRMAdGroup<br><br><br>alternatively<br><br>https://docs.microsoft.com/en-us/azure/cli-install-nodejs<br>http://aka.ms/webpi-azure-cli<br><br>azure login<br><br>https://docs.microsoft.com/en-us/azure/xplat-cli-connect<br><br>azure login -u myUserName@contoso.onmicrosoft.com<br><br>You can also just log into the Azure portal<br><br>log into https://portal.azure.com/<br><br>https://docs.microsoft.com/en-us/rest/api/<br><br>Also you can do the following:<br><br>In google search:<br><br>inurl:adfs/ls/IdpInitiatedSignOn.aspx site: clientdomain.com<br><br>inurl:/idp/startSSO.ping?PartnerSpId= site: clientdomain.com<br><br>If you have a page come back they typically include site where federated authentication can be used.<br><br>Azure - https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/april/introducing-azucar/<br>","remediationInstructions":"Configure Azure to enforce the use of Multi-Factor Authentication (MFA).  This can be done from the  Azure MFA Management Portal.<br>For more information visit: <br>https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-whats-next<br>","name":"Weak Configuration - MFA Not Enabled - Azure","sourceId":"M:161d90c9-6083-e711-80fd-ecf4bbd04083","severity":"Medium","businessImpact":"If an attacker successfully guesses a Azure AD user's password they will be able to access that user's Azure resources from the internet.  This could also lead to unauthorized access to the affected user's system and connected networks.<br>","description":"The Azure configuration does not currently enforce multi-factor authentication (MFA) for all accounts.<br>"}}}